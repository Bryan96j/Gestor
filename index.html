<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Asientos - Transporte Tur√≠stico</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
         
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #0f3460;
            --free: #3498db;
            --reserved: #e74c3c;
            --partial1: #e67e22;
            --partial2: #f1c40f;
            --paid: #2ecc71;
            --text-light: #f0f5ed;
            --text-dark: #2c3e50;
            --card-bg: rgba(255, 255, 255, 0.08);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --modal-bg: rgba(26, 26, 46, 0.95);
            --error: #ff6b6b;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--text-light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #4cc9f0, #4361ee);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgb(0, 0, 0);
            flex: 1;
            min-width: 250px;
        }
        
        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #4cc9f0;
            font-size: 1.3rem;
        }
        
        .card-title i {
            font-size: 1.5rem;
        }
        
        .stats {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat {
            background: rgb(0, 0, 0);
            border-radius: 10px;
            padding: 15px;
            flex: 1;
            min-width: 120px;
            text-align: center;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 3px rgb(0, 0, 0);
        }
        
        .stat-label {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 2;
            margin-bottom: 10px;
            font-weight: 500;
            text-shadow: 0 1px 2px rgb(0, 0, 0);
        }
        
        .stat-percentage {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            z-index: 1;
            opacity: 0.1;
        }
        
        .stat-info {
            font-size: 1.8rem;
            margin-top: 5px;
            font-weight: bold;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 3px rgb(0, 0, 0);
        }

        
        .free .stat-value, .free .stat-label, .free .stat-info { color: var(--free); }
        .free .stat-percentage { background-color: var(--free); }
        
        .reserved .stat-value, .reserved .stat-label, .reserved .stat-info { color: var(--reserved); }
        .reserved .stat-percentage { background-color: var(--reserved); }
        
        .partial1 .stat-value, .partial1 .stat-label, .partial1 .stat-info { color: var(--partial1); }
        .partial1 .stat-percentage { background-color: var(--partial1); }
        
        .partial2 .stat-value, .partial2 .stat-label, .partial2 .stat-info { color: var(--partial2); }
        .partial2 .stat-percentage { background-color: var(--partial2); }
        
        .paid .stat-value, .paid .stat-label, .paid .stat-info { color: var(--paid); }
        .paid .stat-percentage { background-color: var(--paid); }
        
        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn.active {
            background: linear-gradient(to right, #4361ee, #4cc9f0);
            box-shadow: 0 0 15px rgb(67, 98, 238);
        }
        
        .btn-delete {
            background: #e74c3c;
        }
        
        .btn-update {
            background: #f39c12;
        }
        
        .btn-confirm {
            background: #2ecc71;
        }
        
        .vehicle-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            background: var(--card-bg);
            padding: 15px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }
        
        .vehicle-option {
            flex: 1;
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.2);
        }
        
        .vehicle-option:hover {
            background: rgba(67, 97, 238, 0.2);
        }
        
        .vehicle-option.active {
            background: rgba(67, 97, 238, 0.4);
            box-shadow: 0 0 15px rgba(67, 97, 238, 0.3);
        }
        
        .vehicle-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            color: #4cc9f0;
        }
        
        .seat-map-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        .seat-map-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .seat-map {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin: 0 auto;
            max-width: 800px;
        }
        
        .buseta .seat-map {
            grid-template-columns: repeat(4, 1fr);
        }
        
        .seat {
            aspect-ratio: 1;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            padding: 5px;
            min-height: 80px;
        }
        
        .seat:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .seat::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), transparent);
            z-index: 1;
            pointer-events: none;
        }
        
        .seat-number {
            position: relative;
            z-index: 2;
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .seat-name {
            position: relative;
            z-index: 2;
            font-size: 0.7rem;
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            max-width: 95%;
        }
        
        .free { background-color: var(--free); }
        .reserved { background-color: var(--reserved); }
        .partial1 { background-color: var(--partial1); }
        .partial2 { background-color: var(--partial2); color: var(--text-dark); }
        .paid { background-color: var(--paid); }

     
        .driver-area {
            grid-column: span 5;
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        .buseta .driver-area {
            grid-column: span 4;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 25px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        .reservation-form {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            max-width: 500px;
            margin: 0 auto;
        }
        
        .form-title {
            text-align: center;
            margin-bottom: 20px;
            color: #4cc9f0;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            color: white;
            font-size: 1rem;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4cc9f0;
        }
        
        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .btn-submit {
            flex: 1;
            background: linear-gradient(to right, #4361ee, #4cc9f0);
        }
        
        .btn-cancel {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--modal-bg);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            transform: translateY(20px);
            transition: transform 0.4s ease;
        }
        
        .modal.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            font-size: 1.8rem;
            color: #4cc9f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .modal-close:hover {
            transform: rotate(90deg);
        }
        
        .seat-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }
        
        .seat-info .seat {
            width: 80px;
            height: 80px;
            margin-bottom: 15px;
            pointer-events: none;
        }
        
        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .modal-body {
            padding: 20px;
            text-align: center;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .modal-body .icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #4cc9f0;
        }
        
        .error-message {
            color: var(--error);
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }
        
        .input-error {
            border: 1px solid var(--error) !important;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            opacity: 0.7;
            font-size: 0.9rem;
        }

        .free-stat {
            background-color: var(--free);
            color: #ffffff;
        }
        
        .reserved-stat {
            background-color: var(--reserved);
            color: #fff;
        }

        .partial1-stat {
            background-color: var(--partial1);
            color: #ffffff;
        }
        
        .partial2-stat {
            background-color: var(--partial2);
            color: #ffffff;
        }
        
        .paid-stat {
            background-color: var(--paid);
            color: #fff;
        }
        
        .notification-modal .modal-content {
            max-width: 400px;
        }
        
        .notification-modal .modal-body {
            padding: 30px;
        }
        
        .notification-modal .icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .success .icon {
            color: var(--paid);
        }
        
        .error .icon {
            color: var(--reserved);
        }
        
        .notification-modal .btn-confirm {
            margin: 0 auto;
        }
        
        /* SOLUCI√ìN PARA EL SCROLL EN LISTA DE CLIENTES */
        #client-list-body {
            max-height: 50vh;
            overflow-y: auto;
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            background: rgba(0,0,0,0.1);
            scrollbar-width: thin;
            scrollbar-color: #4cc9f0 transparent;
        }
        
        #client-list-body::-webkit-scrollbar {
            width: 8px;
        }
        
        #client-list-body::-webkit-scrollbar-thumb {
            background-color: #4cc9f0;
            border-radius: 10px;
        }
        
        #client-list-body::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .client-item {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 10px;
            background: rgba(255,255,255,0.05);
            border-left: 4px solid #4cc9f0;
        }
        
        .client-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .client-name {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .client-seats {
            font-size: 0.9rem;
            margin-bottom: 8px;
        }
        
        .client-payment {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .payment-amount {
            font-weight: bold;
            color: #4cc9f0;
        }
        
        .empty-list-message {
            text-align: center;
            opacity: 0.7;
            padding: 20px;
            font-style: italic;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }
            
            .vehicle-selector {
                flex-direction: column;
            }
            
            .seat-map {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .buseta .seat-map {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .stats {
                flex-direction: column;
            }
            
            /* Ajustes para lista de clientes en m√≥viles */
            #client-list-body {
                max-height: 60vh;
            }
            
            .client-item {
                padding: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .seat-map {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .buseta .seat-map {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .driver-area {
                grid-column: span 3;
            }
            
            .buseta .driver-area {
                grid-column: span 2;
            }
            
            .seat {
                min-height: 70px;
            }
            
            .seat-number {
                font-size: 1rem;
            }
            
            .seat-name {
                font-size: 0.65rem;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .modal-title {
                font-size: 1.4rem;
            }
            
            .stat {
                min-width: 100%;
            }
            
            .stat-value {
                font-size: 2.2rem;
            }
            
            .stat-label {
                font-size: 1rem;
            }
            
            .stat-info {
                font-size: 1.6rem;
            }
            
            /* Reducci√≥n de tama√±o para botones en dispositivos m√≥viles */
            .btn {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
        
            .modal-footer .btn {
                padding: 8px 12px;
                font-size: 0.85rem;
                min-width: auto;
            }

            /* Cambiar a disposici√≥n vertical para los botones del modal */
            .modal-footer {
                flex-direction: column;
                gap: 8px;
            }
            
            .modal-footer .btn {
                width: 100%;
                justify-content: center;
            }
    
            /* Ajustar botones del formulario principal */
            .form-actions {
                flex-direction: column;
                gap: 10px;
            }
    
            .form-actions .btn {
                width: 100%;
            }
    
            /* Reducir tama√±o de fuente en el modal */
            .modal-title {
                font-size: 1.3rem;
            }
    
            .modal-body {
                font-size: 1rem;
            }

            /* Ajustar el tama√±o del asiento en el modal */
            .seat-info .seat {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-bus"></i> Gestor de Asientos</h1>
            <p class="subtitle">Sistema para gestionar reservas de transporte tur√≠stico</p>
        </header>

         <!-- Bot√≥n para abrir la lista de clientes -->
        <div style="text-align:center; margin-top: 20px;">
            <button class="btn btn-submit" id="open-client-list"><i class="fas fa-users"></i> Ver Lista de Clientes</button>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-chart-pie"></i>
                    <h2>Estad√≠sticas</h2>
                </div>
                <div class="stats">
                    <div class="stat free-stat">
                        <div class="stat-percentage" id="free-percentage" style="width: 100%"></div>
                        <div class="stat-value" id="free-seats">55</div>
                        <div class="stat-label">Asientos Libres</div>
                        <div class="stat-info" id="free-info">100%</div>
                    </div>
                    <div class="stat reserved-stat">
                        <div class="stat-percentage" id="reserved-percentage" style="width: 0%"></div>
                        <div class="stat-value" id="reserved-seats">0</div>
                        <div class="stat-label">Reservados</div>
                        <div class="stat-info" id="reserved-info">0%</div>
                    </div>
                    <div class="stat partial1-stat">
                        <div class="stat-percentage" id="partial1-percentage" style="width: 0%"></div>
                        <div class="stat-value" id="partial1-seats">0</div>
                        <div class="stat-label">1er Adelanto</div>
                        <div class="stat-info" id="partial1-info">0%</div>
                    </div>
                    <div class="stat partial2-stat">
                        <div class="stat-percentage" id="partial2-percentage" style="width: 0%"></div>
                        <div class="stat-value" id="partial2-seats">0</div>
                        <div class="stat-label">2do Adelanto</div>
                        <div class="stat-info" id="partial2-info">0%</div>
                    </div>
                    <div class="stat paid-stat">
                        <div class="stat-percentage" id="paid-percentage" style="width: 0%"></div>
                        <div class="stat-value" id="paid-seats">0</div>
                        <div class="stat-label">Pago Completo</div>
                        <div class="stat-info" id="paid-info">0%</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="vehicle-selector">
            <div class="vehicle-option active" data-vehicle="bus">
                <i class="fas fa-bus vehicle-icon"></i>
                <h3>Bus Tur√≠stico</h3>
                <p>55 asientos</p>
            </div>
            <div class="vehicle-option" data-vehicle="buseta">
                <i class="fas fa-shuttle-van vehicle-icon"></i>
                <h3>Buseta</h3>
                <p>28 asientos</p>
            </div>
        </div>
        
        <div class="seat-map-container">
            <div class="seat-map-title">
                <h2>Mapa de Asientos - Bus Tur√≠stico</h2>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color free"></div>
                        <span>Libre</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color reserved"></div>
                        <span>Reservado</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color partial1"></div>
                        <span>1er Adelanto</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color partial2"></div>
                        <span>2do Adelanto</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color paid"></div>
                        <span>Pago Completo</span>
                    </div>
                </div>
            </div>
            
            <div class="seat-map bus" id="seat-map">
                <!-- Asientos generados din√°micamente -->
            </div>
        </div>
        
        <div class="reservation-form">
            <h2 class="form-title"><i class="fas fa-ticket-alt"></i> Nueva Reserva</h2>
            <div class="form-group">
                <label for="client-name">Nombre del Cliente</label>
                <input type="text" id="client-name" placeholder="Ingrese nombre completo">
                <div class="error-message" id="name-error">Por favor ingrese el nombre del cliente</div>
            </div>
            
            <div class="form-group">
                <label for="seat-count">N√∫mero de Asientos</label>
                <input type="number" id="seat-count" min="1" max="55" value="1">
                <div class="error-message" id="seat-error">Por favor ingrese un n√∫mero v√°lido de asientos</div>
            </div>
            
            <div class="form-group">
                <label for="payment-status">Estado de Pago</label>
                <select id="payment-status">
                    <option value="reserved">Reservado</option>
                    <option value="partial1">1er Adelanto (50%)</option>
                    <option value="partial2">2do Adelanto (75%)</option>
                    <option value="paid">Pago Completo</option>
                </select>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-cancel" id="cancel-btn">Cancelar</button>
                <button class="btn btn-submit" id="reserve-btn">Confirmar Reserva</button>
            </div>
        </div>
        
        <!-- Modal de lista de clientes -->
        <div class="modal" id="client-list-modal">
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <h2 class="modal-title"><i class="fas fa-users"></i> Lista de Clientes</h2>
                    <button class="modal-close" id="close-client-list">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="client-list-body">
                        <!-- Aqu√≠ se cargan los datos din√°micamente -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-submit" id="share-whatsapp">
                        <i class="fab fa-whatsapp"></i> Compartir por WhatsApp
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal para editar reservas -->
        <div class="modal" id="edit-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title"><i class="fas fa-edit"></i> Editar Reserva</h2>
                    <button class="modal-close" id="close-modal">&times;</button>
                </div>
                
                <div class="seat-info">
                    <div class="seat free" id="modal-seat">
                        <div class="seat-number">1</div>
                        <div class="seat-name">Disponible</div>
                    </div>
                    <h3 id="modal-seat-title">Asiento #1</h3>
                </div>
                
                <div class="form-group">
                    <label for="edit-name">Nombre del Cliente</label>
                    <input type="text" id="edit-name" placeholder="Ingrese nombre del cliente">
                </div>
                
                <div class="form-group">
                    <label for="edit-status">Estado de Pago</label>
                    <select id="edit-status">
                        <option value="reserved">Reservado</option>
                        <option value="partial1">1er Adelanto (50%)</option>
                        <option value="partial2">2do Adelanto (75%)</option>
                        <option value="paid">Pago Completo</option>
                    </select>
                </div>
                
                <div class="modal-footer">
                    <button class="btn btn-delete" id="delete-btn">
                        <i class="fas fa-trash"></i> Eliminar
                    </button>
                    <button class="btn btn-update" id="update-btn">
                        <i class="fas fa-sync"></i> Actualizar
                    </button>
                    <button class="btn btn-confirm" id="save-btn">
                        <i class="fas fa-save"></i> Guardar
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal para notificaciones -->
        <div class="modal notification-modal" id="notification-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="notification-title"><i class="fas fa-info-circle"></i> Notificaci√≥n</h2>
                    <button class="modal-close" id="close-notification">&times;</button>
                </div>
                
                <div class="modal-body">
                    <div class="icon" id="notification-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <p id="notification-message">Contenido de la notificaci√≥n</p>
                </div>
                
                <div class="modal-footer" style="justify-content: center;">
                    <button class="btn btn-confirm" id="notification-ok">Aceptar</button>
                </div>
            </div>
        </div>

        <!-- Modal de edici√≥n de pagos -->
        <div class="modal" id="payment-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title"><i class="fas fa-money-bill-wave"></i> Editar Pago</h2>
                    <button class="modal-close" id="close-payment-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="payment-modal-client" style="margin-bottom: 10px;"></p>
                    <div class="form-group">
                        <label for="payment-amount">Monto Pagado (‚Ç°)</label>
                        <input type="number" id="payment-amount" min="0" placeholder="Ingrese el monto pagado">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-submit" id="save-payment-btn"><i class="fas fa-save"></i> Guardar Pago</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Sistema de Gesti√≥n de Asientos &copy; 2025 | Bryan E.P ü§ô</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Nueva estructura de datos unificada
            let appData = {
                seats: {
                    bus: Array(55).fill().map((_, i) => ({
                        id: i + 1,
                        status: 'free',
                        client: ''
                    })),
                    buseta: Array(28).fill().map((_, i) => ({
                        id: i + 1,
                        status: 'free',
                        client: ''
                    }))
                },
                payments: {}  // Almacena pagos por cliente
            };

            // Funci√≥n para migrar datos antiguos
            function migrateOldData() {
                try {
                    const oldData = localStorage.getItem('seatManagerData');
                    if (oldData) {
                        const parsedData = JSON.parse(oldData);
                        
                        // Verificar si son datos antiguos (sin payments)
                        if (parsedData.bus && parsedData.buseta && !parsedData.payments) {
                            console.log("Migrando datos antiguos...");
                            
                            // Migrar asientos
                            appData.seats = parsedData;
                            
                            // Inicializar pagos vac√≠os
                            appData.payments = {};
                            
                            // Guardar nueva estructura
                            localStorage.setItem('seatManagerData', JSON.stringify(appData));
                            
                            console.log("Migraci√≥n completada");
                            return true;
                        }
                    }
                } catch (e) {
                    console.error("Error en migraci√≥n:", e);
                }
                return false;
            }
            
            // Cargar datos desde localStorage
            function loadData() {
                const savedData = localStorage.getItem('seatManagerData');
                if (savedData) {
                    try {
                        const parsedData = JSON.parse(savedData);
                        
                        // Si es la nueva estructura
                        if (parsedData.seats && parsedData.payments) {
                            appData = parsedData;
                            return true;
                        }
                    } catch (e) {
                        console.error('Error al cargar datos:', e);
                    }
                }
                
                // Intentar migrar datos antiguos
                return migrateOldData();
            }
            
            // Guardar datos en localStorage
            function saveData() {
                localStorage.setItem('seatManagerData', JSON.stringify(appData));
            }
            
            const vehicleOptions = document.querySelectorAll('.vehicle-option');
            const seatMap = document.getElementById('seat-map');
            const freeSeatsEl = document.getElementById('free-seats');
            const reservedSeatsEl = document.getElementById('reserved-seats');
            const partial1SeatsEl = document.getElementById('partial1-seats');
            const partial2SeatsEl = document.getElementById('partial2-seats');
            const paidSeatsEl = document.getElementById('paid-seats');
            const editModal = document.getElementById('edit-modal');
            const closeModal = document.getElementById('close-modal');
            const modalSeat = document.getElementById('modal-seat');
            const modalSeatTitle = document.getElementById('modal-seat-title');
            const editName = document.getElementById('edit-name');
            const editStatus = document.getElementById('edit-status');
            const saveBtn = document.getElementById('save-btn');
            const deleteBtn = document.getElementById('delete-btn');
            const updateBtn = document.getElementById('update-btn');
            
            // Modal de notificaciones
            const notificationModal = document.getElementById('notification-modal');
            const notificationTitle = document.getElementById('notification-title');
            const notificationMessage = document.getElementById('notification-message');
            const notificationIcon = document.getElementById('notification-icon');
            const closeNotification = document.getElementById('close-notification');
            const notificationOk = document.getElementById('notification-ok');
            
            // Validaci√≥n de formulario
            const nameError = document.getElementById('name-error');
            const seatError = document.getElementById('seat-error');
            const clientNameInput = document.getElementById('client-name');
            const seatCountInput = document.getElementById('seat-count');
            
            // Elementos del modal de clientes
            const clientListModal = document.getElementById('client-list-modal');
            const openClientListBtn = document.getElementById('open-client-list');
            const closeClientListBtn = document.getElementById('close-client-list');
            const clientListBody = document.getElementById('client-list-body');
            const shareWhatsappBtn = document.getElementById('share-whatsapp');
            
            // Modal de edici√≥n de pagos
            const paymentModal = document.getElementById('payment-modal');
            const paymentModalClient = document.getElementById('payment-modal-client');
            const paymentAmountInput = document.getElementById('payment-amount');
            const closePaymentModal = document.getElementById('close-payment-modal');
            const savePaymentBtn = document.getElementById('save-payment-btn');
            let editingClient = null;
            
            let currentVehicle = 'bus';
            let currentSeat = null;
            
            // Inicializar la aplicaci√≥n
            loadData();
            renderSeatMap();
            updateStats();
            
            // Funci√≥n para mostrar notificaciones personalizadas
            function showNotification(title, message, type = 'info') {
                notificationTitle.innerHTML = `<i class="fas fa-${type === 'error' ? 'exclamation-triangle' : 'info-circle'}"></i> ${title}`;
                notificationMessage.textContent = message;
                
                // Determinar el icono y color seg√∫n el tipo
                let iconClass, iconColor;
                if (type === 'error') {
                    iconClass = 'exclamation-triangle';
                    iconColor = '#e74c3c';
                } else if (type === 'success') {
                    iconClass = 'check-circle';
                    iconColor = '#2ecc71';
                } else {
                    iconClass = 'info-circle';
                    iconColor = '#4cc9f0';
                }
                
                notificationIcon.innerHTML = `<i class="fas fa-${iconClass}" style="color: ${iconColor}"></i>`;
                
                notificationModal.classList.add('active');
            }
            
            // Cerrar modal de notificaciones
            closeNotification.addEventListener('click', () => {
                notificationModal.classList.remove('active');
            });
            
            notificationOk.addEventListener('click', () => {
                notificationModal.classList.remove('active');
            });
            
            // Validar formulario
            function validateForm() {
                let isValid = true;
                
                // Resetear errores
                nameError.style.display = 'none';
                seatError.style.display = 'none';
                clientNameInput.classList.remove('input-error');
                seatCountInput.classList.remove('input-error');
                
                // Validar nombre
                if (!clientNameInput.value.trim()) {
                    nameError.style.display = 'block';
                    clientNameInput.classList.add('input-error');
                    isValid = false;
                }
                
                // Validar n√∫mero de asientos
                const seatCount = parseInt(seatCountInput.value);
                if (isNaN(seatCount)) {
                    seatError.textContent = 'Por favor ingrese un n√∫mero v√°lido';
                    seatError.style.display = 'block';
                    seatCountInput.classList.add('input-error');
                    isValid = false;
                } else if (seatCount < 1) {
                    seatError.textContent = 'Debe reservar al menos un asiento';
                    seatError.style.display = 'block';
                    seatCountInput.classList.add('input-error');
                    isValid = false;
                } else if (seatCount > 55) {
                    seatError.textContent = 'No puede reservar m√°s de 55 asientos';
                    seatError.style.display = 'block';
                    seatCountInput.classList.add('input-error');
                    isValid = false;
                }
                
                return isValid;
            }
            
            // Cambiar veh√≠culo
            vehicleOptions.forEach(option => {
                option.addEventListener('click', () => {
                    vehicleOptions.forEach(o => o.classList.remove('active'));
                    option.classList.add('active');
                    currentVehicle = option.dataset.vehicle;
                    
                    // Actualizar t√≠tulo
                    const title = document.querySelector('.seat-map-title h2');
                    if (currentVehicle === 'bus') {
                        title.textContent = 'Mapa de Asientos - Bus Tur√≠stico';
                        seatMap.classList.remove('buseta');
                        seatMap.classList.add('bus');
                    } else {
                        title.textContent = 'Mapa de Asientos - Buseta';
                        seatMap.classList.remove('bus');
                        seatMap.classList.add('buseta');
                    }
                    
                    renderSeatMap();
                    updateStats();
                });
            });
            
            // Renderizar mapa de asientos
            function renderSeatMap() {
                seatMap.innerHTML = '';
                
                // Agregar √°rea del conductor
                const driverArea = document.createElement('div');
                driverArea.className = 'driver-area';
                driverArea.innerHTML = '<i class="fas fa-steering-wheel"></i> √ÅREA DEL CONDUCTOR';
                seatMap.appendChild(driverArea);
                
                // Crear asientos
                appData.seats[currentVehicle].forEach(seat => {
                    const seatEl = document.createElement('div');
                    seatEl.className = `seat ${seat.status}`;
                    seatEl.innerHTML = `
                        <div class="seat-number">${seat.id}</div>
                        <div class="seat-name">${seat.client || 'Disponible'}</div>
                    `;
                    
                    // Permitir seleccionar asiento
                    seatEl.addEventListener('click', () => {
                        openEditModal(seat);
                    });
                    
                    seatMap.appendChild(seatEl);
                });
            }
            
            // Abrir modal de edici√≥n
            function openEditModal(seat) {
                currentSeat = seat;
                
                // Actualizar contenido del modal
                modalSeatTitle.textContent = `Asiento #${seat.id}`;
                modalSeat.className = `seat ${seat.status}`;
                modalSeat.innerHTML = `
                    <div class="seat-number">${seat.id}</div>
                    <div class="seat-name">${seat.client || 'Disponible'}</div>
                `;
                
                editName.value = seat.client;
                editStatus.value = seat.status;
                
                editModal.classList.add('active');
            }
            
            // Cerrar modal
            closeModal.addEventListener('click', () => {
                editModal.classList.remove('active');
            });
            
            // Guardar cambios
            saveBtn.addEventListener('click', () => {
                if (currentSeat) {
                    currentSeat.client = editName.value;
                    currentSeat.status = editStatus.value;
                    
                    renderSeatMap();
                    updateStats();
                    saveData();
                    editModal.classList.remove('active');
                    showNotification('Reserva Actualizada', `La reserva para el asiento #${currentSeat.id} ha sido actualizada`, 'success');
                }
            });
            
            // Eliminar reserva
            deleteBtn.addEventListener('click', () => {
                if (currentSeat) {
                    currentSeat.client = '';
                    currentSeat.status = 'free';
                    
                    renderSeatMap();
                    updateStats();
                    saveData();
                    editModal.classList.remove('active');
                    showNotification('Reserva Eliminada', `La reserva para el asiento #${currentSeat.id} ha sido eliminada`, 'success');
                }
            });
            
            // Actualizar estado
            updateBtn.addEventListener('click', () => {
                if (currentSeat) {
                    currentSeat.status = editStatus.value;
                    modalSeat.className = `seat ${currentSeat.status}`;
                    
                    renderSeatMap();
                    updateStats();
                    saveData();
                    showNotification('Estado Actualizado', `El estado del asiento #${currentSeat.id} ha sido actualizado`, 'success');
                }
            });
            
            // Actualizar estad√≠sticas
            function updateStats() {
                const vehicleSeats = appData.seats[currentVehicle];
                const totalSeats = vehicleSeats.length;
                const free = vehicleSeats.filter(s => s.status === 'free').length;
                const reserved = vehicleSeats.filter(s => s.status === 'reserved').length;
                const partial1 = vehicleSeats.filter(s => s.status === 'partial1').length;
                const partial2 = vehicleSeats.filter(s => s.status === 'partial2').length;
                const paid = vehicleSeats.filter(s => s.status === 'paid').length;
                
                // Actualizar valores
                freeSeatsEl.textContent = free;
                reservedSeatsEl.textContent = reserved;
                partial1SeatsEl.textContent = partial1;
                partial2SeatsEl.textContent = partial2;
                paidSeatsEl.textContent = paid;
                
                // Calcular porcentajes
                const freePct = Math.round((free / totalSeats) * 100);
                const reservedPct = Math.round((reserved / totalSeats) * 100);
                const partial1Pct = Math.round((partial1 / totalSeats) * 100);
                const partial2Pct = Math.round((partial2 / totalSeats) * 100);
                const paidPct = Math.round((paid / totalSeats) * 100);
                
                // Actualizar barras de porcentaje
                document.getElementById('free-percentage').style.width = `${freePct}%`;
                document.getElementById('reserved-percentage').style.width = `${reservedPct}%`;
                document.getElementById('partial1-percentage').style.width = `${partial1Pct}%`;
                document.getElementById('partial2-percentage').style.width = `${partial2Pct}%`;
                document.getElementById('paid-percentage').style.width = `${paidPct}%`;
                
                // Actualizar textos de porcentaje
                document.getElementById('free-info').textContent = `${freePct}%`;
                document.getElementById('reserved-info').textContent = `${reservedPct}%`;
                document.getElementById('partial1-info').textContent = `${partial1Pct}%`;
                document.getElementById('partial2-info').textContent = `${partial2Pct}%`;
                document.getElementById('paid-info').textContent = `${paidPct}%`;
            }
            
            // Reservar asientos
            document.getElementById('reserve-btn').addEventListener('click', function() {
                const clientName = document.getElementById('client-name').value.trim();
                const seatCount = parseInt(document.getElementById('seat-count').value);
                const paymentStatus = document.getElementById('payment-status').value;
                
                // Validar formulario
                if (!validateForm()) return;
                
                // Encontrar asientos libres
                const freeSeats = appData.seats[currentVehicle].filter(s => s.status === 'free');
                
                if (freeSeats.length < seatCount) {
                    showNotification('Error', `No hay suficientes asientos disponibles. Quedan ${freeSeats.length} asientos libres.`, 'error');
                    return;
                }
                
                // Reservar los primeros n asientos libres
                let reservedCount = 0;
                for (let i = 0; i < appData.seats[currentVehicle].length && reservedCount < seatCount; i++) {
                    if (appData.seats[currentVehicle][i].status === 'free') {
                        appData.seats[currentVehicle][i].status = paymentStatus;
                        appData.seats[currentVehicle][i].client = clientName;
                        reservedCount++;
                    }
                }
                
                // Actualizar UI
                renderSeatMap();
                updateStats();
                saveData();
                
                // Resetear formulario
                document.getElementById('client-name').value = '';
                document.getElementById('seat-count').value = 1;
                
                showNotification('Reserva Exitosa', `${seatCount} asientos reservados para ${clientName}`, 'success');
            });
            
            // Cancelar reserva
            document.getElementById('cancel-btn').addEventListener('click', function() {
                document.getElementById('client-name').value = '';
                document.getElementById('seat-count').value = 1;
                
                // Limpiar errores
                nameError.style.display = 'none';
                seatError.style.display = 'none';
                clientNameInput.classList.remove('input-error');
                seatCountInput.classList.remove('input-error');
            });
            
            // Funci√≥n para mostrar la lista de clientes con scroll
            function renderClientList() {
                const allSeats = appData.seats[currentVehicle];
                const clientMap = {};
                
                // Agrupar por cliente
                allSeats.forEach(seat => {
                    if (seat.client.trim()) {
                        if (!clientMap[seat.client]) {
                            clientMap[seat.client] = {
                                seats: [],
                                payment: appData.payments[seat.client] || 0
                            };
                        }
                        clientMap[seat.client].seats.push(seat.id);
                    }
                });
                
                // Construir HTML con nuevo formato
                clientListBody.innerHTML = '';
                
                if (Object.keys(clientMap).length === 0) {
                    clientListBody.innerHTML = '<p class="empty-list-message">No hay clientes registrados</p>';
                    return;
                }
                
                Object.entries(clientMap).forEach(([client, data]) => {
                    const div = document.createElement('div');
                    div.className = 'client-item';
                    div.innerHTML = `
                        <div class="client-header">
                            <div class="client-name">${client}</div>
                            <button class="btn btn-update" onclick="editPayment('${client}')">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                        </div>
                        <div class="client-seats">Asientos: ${data.seats.join(', ')}</div>
                        <div class="client-payment">
                            <div>Monto pagado:</div>
                            <div class="payment-amount">‚Ç°${data.payment.toLocaleString('es-CR')}</div>
                        </div>
                    `;
                    clientListBody.appendChild(div);
                });
            }
            
            // Mostrar lista de clientes
            openClientListBtn.addEventListener('click', () => {
                renderClientList();
                clientListModal.classList.add('active');
            });
            
            // Funci√≥n global para editar pagos
            window.editPayment = function(client) {
                editingClient = client;
                paymentModalClient.textContent = `Cliente: ${client}`;
                paymentAmountInput.value = appData.payments[client] || '';
                paymentModal.classList.add('active');
            };
            
            // Guardar pago
            savePaymentBtn.addEventListener('click', () => {
                const value = parseFloat(paymentAmountInput.value);
                if (!isNaN(value) && editingClient) {
                    // Guardar en appData.payments
                    appData.payments[editingClient] = value;
                    
                    // Actualizar UI inmediatamente
                    renderClientList();
                    
                    // Guardar en localStorage
                    saveData();
                    
                    paymentModal.classList.remove('active');
                    showNotification('Pago Actualizado', `El monto pagado por ${editingClient} ha sido actualizado`, 'success');
                } else {
                    showNotification('Error', 'Por favor ingrese un monto v√°lido', 'error');
                }
            });
            
            // Cerrar modal de clientes
            closeClientListBtn.addEventListener('click', () => {
                clientListModal.classList.remove('active');
            });
            
            // Cerrar modal de pago
            closePaymentModal.addEventListener('click', () => {
                paymentModal.classList.remove('active');
            });
            
            // Compartir por WhatsApp
            shareWhatsappBtn.addEventListener('click', () => {
                const allSeats = appData.seats[currentVehicle];
                const clientMap = {};
                
                allSeats.forEach(seat => {
                    if (seat.client.trim()) {
                        if (!clientMap[seat.client]) clientMap[seat.client] = [];
                        clientMap[seat.client].push(seat.id);
                    }
                });
                
                let message = '*Reservas de Clientes:*\n\n';
                for (let client in clientMap) {
                    const seatsList = clientMap[client].join(', ');
                    const paid = (appData.payments[client] || 0).toLocaleString('es-CR');
                    message += `üë§ ${client}:\nüéüÔ∏è Asientos: ${seatsList}\nüí∞ Pagado: ‚Ç°${paid}\n\n`;
                }
                
                const encodedMsg = encodeURIComponent(message);
                const whatsappURL = `https://wa.me/?text=${encodedMsg}`;
                window.open(whatsappURL, '_blank');
            });
            
            // Simular algunos asientos reservados para demostraci√≥n
            setTimeout(() => {
                // Si no hay datos guardados, crear datos de demostraci√≥n
                if (!localStorage.getItem('seatManagerData')) {
                    // Reservar algunos asientos de ejemplo
                    appData.seats.bus[0].status = 'reserved';
                    appData.seats.bus[0].client = 'Juan P√©rez';
                    appData.seats.bus[1].status = 'partial1';
                    appData.seats.bus[1].client = 'Mar√≠a Rodr√≠guez';
                    appData.seats.bus[2].status = 'partial2';
                    appData.seats.bus[2].client = 'Carlos G√≥mez';
                    appData.seats.bus[3].status = 'paid';
                    appData.seats.bus[3].client = 'Laura Mart√≠nez';
                    
                    appData.seats.buseta[0].status = 'reserved';
                    appData.seats.buseta[0].client = 'Ana L√≥pez';
                    appData.seats.buseta[1].status = 'paid';
                    appData.seats.buseta[1].client = 'Pedro S√°nchez';
                    
                    // Agregar pagos de ejemplo
                    appData.payments['Juan P√©rez'] = 25000;
                    appData.payments['Mar√≠a Rodr√≠guez'] = 50000;
                    appData.payments['Carlos G√≥mez'] = 75000;
                    appData.payments['Laura Mart√≠nez'] = 100000;
                    appData.payments['Ana L√≥pez'] = 15000;
                    appData.payments['Pedro S√°nchez'] = 30000;
                    
                    saveData();
                }
                
                renderSeatMap();
                updateStats();
            }, 500);
        });
    </script>
</body>
</html>
